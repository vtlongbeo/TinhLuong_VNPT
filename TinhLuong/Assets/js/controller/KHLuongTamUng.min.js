function update(a, n) { var t = $(n).data("id"); $("#myModal").modal("show"), KHLuongTamUng.LoadDataID(t) } function dele(a, n) { if (confirm("Có chắc chắn muốn xóa?")) { var t = $(n).data("id"); KHLuongTamUng.Delete(t) } } var KHLuongTamUng = { init: function () { $("#drpNam").change(function () { return $("#LanhDao").empty(), $.ajax({ url: "/TinhLuongBoSungQuy/LoadLanhDao", data: { Nam: $("#drpNam").val() }, dataType: "json", type: "POST", success: function (a) { $("#LanhDao").append("<option>--Chọn--</option>"), $.each(a, function (a, n) { $("#LanhDao").append('<option value="' + n.Value + '">' + n.Text + "</option>") }) }, error: function (a) { alert("Failed to retrieve states." + a) } }), !1 }), $("#viewLuongKH").click(function () { $("#drpNam").val() > 0 ? KHLuongTamUng.LoadData() : alert("Vui lòng chọn năm để xem dữ liệu") }), $("#AddNewLuongKH").click(function () { $("#LanhDao").val() > 0 ? KHLuongTamUng.AddNew($("#LanhDao").val(), $("#drpNam").val()) : alert("Vui lòng chọn lãnh đạo trước khi thêm dữ liệu") }), $("#addLuongKH").click(function () { $("#drpNam").val() > 0 ? $("#AddNew").modal("show") : alert("Vui lòng chọn năm trước khi thêm mới dữ liệu") }), $("#UdpateLuongKH").click(function () { confirm("Có muốn thực hiện?") && ($("#LuongKHTamUng").val() >= 0 ? (KHLuongTamUng.SaveData(), $("#myModal").modal("hide")) : alert("Vui lòng nhập Lương KH tạm ứng")) }), KHLuongTamUng.registerEvent() }, registerEvent: function () { }, LoadFind: function () { }, AddNew: function (a, n) { $("#LuongKHTamUng").val(), $("#IsActive").prop("checked"), $("#ID").val(); $.ajax({ url: "/TinhLuongBoSungQuy/AddNewLanhDao", type: "POST", dataType: "json", data: { LanhDao: a, Nam: n }, success: function (a) { a.status ? (alert("Thêm mới thành công"), $("#AddNew").modal("hide"), KHLuongTamUng.LoadData()) : alert("Xảy ra lỗi thực thi hoặc Nhân sự đã tồn tại trong bảng!") } }) }, Delete: function (a) { $.ajax({ url: "/TinhLuongBoSungQuy/DeleteLanhDao", type: "POST", dataType: "json", data: { ID: a }, success: function (a) { a.status ? (alert("Xóa thành công"), KHLuongTamUng.LoadData()) : alert("Xảy ra lỗi thực thi. Vui lòng thử lại!") } }) }, LoadData: function () { $("#divLoading").show(), $.ajax({ url: "/TinhLuongBoSungQuy/LoadDataLuongKHTamUng", type: "GET", dataType: "json", data: { Nam: $("#drpNam").val() }, success: function (a) { if (a.status) { var n = a.data, t = "", o = $("#KhTamUng").html(); $.each(n, function (a, n) { t += Mustache.render(o, { STT: n.STT, Nam: n.Nam, DonViID: n.DonViID, NhanSuID: n.NhanSuID, HoTen: n.HoTen, LuongKHTamUng: n.LuongKHTamUng, TenDonVi: n.TenDonVi, IsActive: 1 == n.IsActive ? '<span class="label label-success">Đang dùng</span>' : '<span class="label label-danger">Đang khóa</span>' }) }), $("#tbodyKHTamUng").html(t), n.length > 0 ? ($("#example1_info").show(), $("#example1_paginate").show(), $("#example1").DataTable()) : ($("#example1_info").hide(), $("#example1_paginate").hide()), KHLuongTamUng.registerEvent(), $("#divLoading").hide() } else alert("Gặp vấn đề khi tải dữ liệu, Vui lòng thử lại!"), window.location.reload() } }) }, LoadDataID: function (a) { $.ajax({ url: "/TinhLuongBoSungQuy/GetLuongKHTamUng_ID", type: "GET", dataType: "json", data: { ID: a }, success: function (n) { if (n.status) { var t = n.data; $("#ID").val(a), $("#HoTen").val(t[0].HoTen), $("#LuongKHTamUng").val(t[0].LuongKHTamUng), $("#IsActive").prop("checked", t[0].IsActive), $("#divLoading").hide() } else alert("Gặp vấn đề khi tải dữ liệu, Vui lòng thử lại!"), window.location.reload() } }) }, SaveData: function () { var a = $("#LuongKHTamUng").val(), n = $("#IsActive").prop("checked"), t = $("#ID").val(); $.ajax({ url: "/TinhLuongBoSungQuy/UpdateLuongKH", type: "POST", dataType: "json", data: { ID: t, LuongKHTamUng: a, IsActive: n }, success: function (a) { a.status ? KHLuongTamUng.LoadData() : alert("Gặp vấn đề khi tải dữ liệu, Vui lòng thử lại!") } }) } }; KHLuongTamUng.init();