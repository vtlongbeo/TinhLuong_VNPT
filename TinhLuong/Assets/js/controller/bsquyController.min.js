function searchCaNhan(a, n, i) { if (13 == a.which) { var o = $(n).val(); bsquyController.LoadData_BangThongTin(o, i, $("#drpNam").val(), $("#LoaiBS").val(), !0) } } function searchToTram(a, n, i) { if (13 == a.which) { var o = $(n).val(); bsquyController.LoadData_BSDV(o, i, $("#drpNam").val(), $("#LoaiBS").val(), !0) } } function searchBSDV(a, n) { if (13 == a.which) { var i = $(n).val(); bsquyController.LoadData_NguonBSDV(i, $("#drpNam").val(), $("#LoaiBS").val(), !0) } } function update_bangThongTin(a, n, i) { if (13 == a.which) { var o = $(n).data("id"), t = $(n).val(); $.ajax({ url: "/TinhLuongBoSungQuy/UpdateBSQuy", type: "POST", dataType: "json", data: { ID: o, Value: t, Type: i }, success: function (a) { 0 == a.status ? alert("Cập nhật thất bại. Vui lòng thử lại") : alert("Cập nhật thành công") } }) } } function update_SoTK(a, n) { if (13 == a.which) { var i = $(n).data("id"), o = $(n).val(); $.ajax({ url: "/TinhLuongBoSungQuy/UpdateBSQuy", type: "POST", dataType: "json", data: { ID: i, Value: o }, success: function (a) { 0 == a.status ? alert("Cập nhật thất bại. Vui lòng thử lại") : alert("Cập nhật thành công") } }) } } var homeconfig = { pageSize: 15, pageIndex1: 1, pageIndex: 1, pageIndex2: 1, pageIndex3: 1 }, bsquyController = { init: function () { $("#XoaLuongBS").click(function () { confirm("Bạn có muốn xóa không?") && ($("#drpNam").val() > 0 && $("#LoaiBS").val() > 0 ? bsquyController.DeleteLuongBoSung($("#drpNam").val(), $("#LoaiBS").val()) : alert("Vui lòng chọn đầy đủ thông tin trước thực hiện")) }), $("#TinhLuongBS").click(function () { confirm("Có muốn thực hiện?") && ($("#drpNam").val() > 0 && $("#LoaiBS").val() > 0 ? bsquyController.TinhLuongBoSung($("#drpNam").val(), $("#LoaiBS").val()) : alert("Vui lòng chọn đầy đủ thông tin trước khi tính toán")) }), $("#viewSalary").click(function () { $("#drpNam").val() > 0 && $("#LoaiBS").val() > 0 ? (bsquyController.LoadData_BangThongTin(null, null, $("#drpNam").val(), $("#LoaiBS").val(), !1), bsquyController.LoadData_BSDV(null, null, $("#drpNam").val(), $("#LoaiBS").val(), !1), bsquyController.LoadData_BSLanhDao($("#drpNam").val(), $("#LoaiBS").val(), !1), bsquyController.LoadData_NguonBSDV(null, $("#drpNam").val(), $("#LoaiBS").val(), !1)) : alert("Vui lòng chọn đầy đủ thông tin xem thông tin") }), $("#drpNam").change(function () { return $("#LoaiBS").empty(), $.ajax({ url: "/TinhLuongBoSungQuy/LoadBS", data: { Nam: $("#drpNam").val() }, dataType: "json", type: "POST", success: function (a) { $("#LoaiBS").append("<option>--Chọn--</option>"), $.each(a, function (a, n) { $("#LoaiBS").append('<option value="' + n.Value + '">' + n.Text + "</option>") }) }, error: function (a) { alert("Failed to retrieve states." + a) } }), !1 }), bsquyController.registerEvent() }, registerEvent: function () { $(".P3Quy_BSDV").off("keypress").on("keypress", function (a) { if (13 == a.which) { var n = $(this).data("id"), i = $(this).val(); $.ajax({ url: "/TinhLuongBoSungQuy/UpdateBSQuy", type: "POST", dataType: "json", data: { ID: n, Value: i, Type: "P3BSDV" }, success: function (a) { 0 == a.status ? alert("Cập nhật thất bại. Vui lòng thử lại") : alert("Cập nhật thành công") } }) } }), $(".P2Quy_BangThongTin").off("keypress").on("keypress", function (a) { if (13 == a.which) { var n = $(this).data("id"), i = $(this).val(); $.ajax({ url: "/TinhLuongBoSungQuy/UpdateBSQuy", type: "POST", dataType: "json", data: { ID: n, Value: i, Type: "P2" }, success: function (a) { 0 == a.status ? alert("Cập nhật thất bại. Vui lòng thử lại") : alert("Cập nhật thành công") } }) } }), $(".P3Quy_BangThongTin").off("keypress").on("keypress", function (a) { if (13 == a.which) { var n = $(this).data("id"), i = $(this).val(); $.ajax({ url: "/TinhLuongBoSungQuy/UpdateBSQuy", type: "POST", dataType: "json", data: { ID: n, Value: i, Type: "P3" }, success: function (a) { 0 == a.status ? alert("Cập nhật thất bại. Vui lòng thử lại") : alert("Cập nhật thành công") } }) } }), $(".GiamTruQuyLuong_BSDV").off("keypress").on("keypress", function (a) { if (13 == a.which) { var n = $(this).data("id"), i = $(this).val(); $.ajax({ url: "/TinhLuongBoSungQuy/UpdateBSQuy", type: "POST", dataType: "json", data: { ID: n, Value: i, Type: "GIAMTRUQUYLUONG" }, success: function (a) { 0 == a.status ? alert("Cập nhật thất bại. Vui lòng thử lại") : alert("Cập nhật thành công") } }) } }) }, FindTable: function () { $("#tblBSDV").DataTable(), $("#example2").DataTable(), $("#example1").DataTable(), $("#example22").DataTable() }, TinhLuongBoSung: function (a, n) { $("#divLoading").show(), $.ajax({ url: "/TinhLuongBoSungQuy/TinhLuongBoSung", type: "POST", dataType: "json", data: { Nam: a, LoaiBS: n }, success: function (a) { window.location.reload() } }) }, DeleteLuongBoSung: function (a, n) { $("#divLoading").show(), $.ajax({ url: "/TinhLuongBoSungQuy/DeleteLuongBoSung", type: "POST", dataType: "json", data: { Nam: a, LoaiBS: n }, success: function (a) { window.location.reload() } }) }, LoadData_BangThongTin: function (a, n, i, o, t) { $("#divLoading").show(), $.ajax({ url: "/TinhLuongBoSungQuy/LoadData_BangThongTin", type: "GET", dataType: "json", data: { value: a, type: n, Nam: i, LoaiBS: o, page: homeconfig.pageIndex, pageSize: homeconfig.pageSize }, success: function (a) { if (a.status) { var n = a.dataBangThongTin, i = "", o = $("#BangThongTin").html(); $.each(n, function (a, n) { i += Mustache.render(o, { STT: n.STT, Quy: n.Quy, Nam: n.Nam, DonViChaID: n.DonViChaID, DonViID: n.DonViID, NhanSuID: n.NhanSuID, HoTen: n.HoTen, P1TB_Quy: n.P1TB_Quy, P2TB_Quy: n.P2TB_Quy, P3TB_Quy: n.P3TB_Quy, P1P2TB_Quy: n.P1P2TB_Quy, P1P2P3TB_Quy: n.P1P2P3TB_Quy, TongTienBoSung: n.TongTienBoSung, SoTaiKhoan: n.SoTaiKhoan, LoaiBS: n.LoaiBS }) }), $("#tbodyBangThongTin").html(i), $("#example1").DataTable(), $("#divLoading").hide() } else alert("Gặp vấn đề khi tải dữ liệu, Vui lòng thử lại!"), window.location.reload() } }) }, LoadData_NguonBSDV: function (a, n, i, o) { $("#divLoading").show(), $.ajax({ url: "/TinhLuongBoSungQuy/LoadData_NguonBSDV", type: "GET", dataType: "json", data: { search: a, Nam: n, LoaiBS: i, page: homeconfig.pageIndex1, pageSize: homeconfig.pageSize }, success: function (a) { if (a.status) { var n = a.dataNguonBSDonVi, i = "", o = $("#NguonBSDV").html(); $.each(n, function (a, n) { i += Mustache.render(o, { STT: n.STT, Quy: n.Quy, Nam: n.Nam, DonViID: n.DonViID, P3Quy: n.P3Quy, DiemP1: n.DiemP1, P1P3: n.P1P3, NguonP3DV: n.NguonP3DV, GiamTruQuyLuong: n.GiamTruQuyLuong, NguonP3SauGiamTru: n.NguonP3SauGiamTru, LoaiBS: n.LoaiBS }) }), $("#tbodyBSDV").html(i), $("#tblBSDV").DataTable(), $("#divLoading").hide() } else alert("Gặp vấn đề khi tải dữ liệu, Vui lòng thử lại!"), window.location.reload() } }) }, LoadData_BSDV: function (a, n, i, o, t) { $("#divLoading").show(), $.ajax({ url: "/TinhLuongBoSungQuy/LoadData_BSDV", type: "GET", dataType: "json", data: { value: a, type: n, Nam: i, LoaiBS: o, page: homeconfig.pageIndex2, pageSize: homeconfig.pageSize }, success: function (a) { if (a.status) { var n = a.dataBSDonVi, i = "", o = $("#BSDonVi").html(); $.each(n, function (a, n) { i += Mustache.render(o, { STT: n.STT, Quy: n.Quy, Nam: n.Nam, DonViID: n.DonViID, DonViChaID: n.DonViChaID, P1: n.P1, P1P2: n.P1P2, P3: n.P3, NguonP3BoSung: n.NguonP3BoSung, TenDonVi: n.TenDonVi, LoaiBS: n.LoaiBS }) }), $("#tbodyBSDV1").html(i), $("#example2").DataTable(), $("#divLoading").hide() } else alert("Gặp vấn đề khi tải dữ liệu, Vui lòng thử lại!"), window.location.reload() } }) }, LoadData_BSLanhDao: function (a, n, i) { $("#divLoading").show(), $.ajax({ url: "/TinhLuongBoSungQuy/LoadData_BSLanhDao", type: "GET", dataType: "json", data: { Nam: a, LoaiBS: n, page: homeconfig.pageIndex3, pageSize: homeconfig.pageSize }, success: function (a) { if (a.status) { var n = a.dataBSDonVi, i = "", o = $("#BSLanhDao").html(); $.each(n, function (a, n) { i += Mustache.render(o, { STT: n.STT, Quy: n.Quy, Nam: n.Nam, DonViID: n.DonViID, DonViChaID: n.DonViChaID, NhanSuID: n.NhanSuID, TienLuongKHP3Quy: n.TienLuongKHP3Quy, P3DonVi: n.P3DonVi, GiamTruTienP3Quy: n.GiamTruTienP3Quy, BoSungP3Quy: n.BoSungP3Quy, HoTen: n.HoTen, LoaiBS: n.LoaiBS }) }), $("#tbodyBSLanhDao").html(i), $("#example22").DataTable(), $("#divLoading").hide() } else alert("Gặp vấn đề khi tải dữ liệu, Vui lòng thử lại!"), window.location.reload() } }) }, paging: function (a, n, i) { 1 != i && 0 != a || ($("#pagination").empty(), $("#pagination").removeData("twbs-pagination"), $("#pagination").unbind("page")); var o = Math.ceil(a / homeconfig.pageSize); $("#pagination").twbsPagination({ totalPages: o, visiblePages: 5, first: "Đầu", next: "Tiếp", prev: "Trước", last: "Cuối", onPageClick: function (a, i) { homeconfig.pageIndex = i, setTimeout(n, 20) } }) }, paging1: function (a, n, i) { 1 != i && 0 != a || ($("#pagination1").empty(), $("#pagination1").removeData("twbs-pagination"), $("#pagination1").unbind("page")); var o = Math.ceil(a / homeconfig.pageSize); $("#pagination1").twbsPagination({ totalPages: o, visiblePages: 5, first: "Đầu", next: "Tiếp", prev: "Trước", last: "Cuối", onPageClick: function (a, i) { homeconfig.pageIndex1 = i, setTimeout(n, 20) } }) }, paging2: function (a, n, i) { 1 != i && 0 != a || ($("#pagination2").empty(), $("#pagination2").removeData("twbs-pagination"), $("#pagination2").unbind("page")); var o = Math.ceil(a / homeconfig.pageSize); $("#pagination2").twbsPagination({ totalPages: o, visiblePages: 5, first: "Đầu", next: "Tiếp", prev: "Trước", last: "Cuối", onPageClick: function (a, i) { homeconfig.pageIndex2 = i, setTimeout(n, 20) } }) }, paging3: function (a, n, i) { 1 != i && 0 != a || ($("#pagination3").empty(), $("#pagination3").removeData("twbs-pagination"), $("#pagination3").unbind("page")); var o = Math.ceil(a / homeconfig.pageSize); $("#pagination3").twbsPagination({ totalPages: o, visiblePages: 5, first: "Đầu", next: "Tiếp", prev: "Trước", last: "Cuối", onPageClick: function (a, i) { homeconfig.pageIndex3 = i, setTimeout(n, 20) } }) } }; bsquyController.init();